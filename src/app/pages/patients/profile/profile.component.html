<nb-card [nbSpinner]="isLoading" class="mb-1">
    <nb-card-body *ngIf="showPatient">
        <img src="assets/svg/404.svg" class="w-100">
        <h1 class="text-center text-muted">Patient not found</h1>
    </nb-card-body>
    <nb-card-body *ngIf="!showPatient">
        <div class="row">
            <div class="col-md-2">
                <div class="py-2">
                    <nb-user class="pb-2 ps-2" size="giant" [name]="patientName"
                        [picture]="patient?.imageUrl" onlyPicture='true'>
                    </nb-user>
                    <div class="subtitle ps-2">{{patientName}}</div>
                    <div class="caption ps-2">{{patient?.dob}}</div>
                </div>
            </div>
            <div class="col-md-3 break-word">
                <p>
                    <nb-icon icon="phone" nbTooltip="Phone" nbTooltipPlacement="left" pack="font-awesome"></nb-icon>
                    <span class="ps-2">{{patient?.phoneNumber}}</span>
                </p>
                <p>
                    <nb-icon icon="email-outline" nbTooltip="Email" nbTooltipPlacement="left"></nb-icon>
                    <span class="ps-2">{{patient?.email}}</span>
                </p>
                <div [ngSwitch]="patient?.gender">
                    <p *ngSwitchCase="0">
                        <nb-icon icon="venus-mars" nbTooltip="Gender" nbTooltipPlacement="left" pack="font-awesome">
                        </nb-icon><span class="ps-2">{{'kMale' | translate}}</span>
                    </p>
                    <p *ngSwitchCase="1">
                        <nb-icon icon="venus-mars" nbTooltip="Gender" nbTooltipPlacement="left" pack="font-awesome">
                        </nb-icon><span class="ps-2">{{'kFemale' | translate}}</span>
                    </p>
                    <p *ngSwitchCase="2">
                        <nb-icon icon="venus-mars" nbTooltip="Gender" nbTooltipPlacement="left" pack="font-awesome">
                        </nb-icon><span class="ps-2">{{'kOther' | translate}}</span>
                    </p>
                </div>
            </div>
            <div class="mt-3" [ngClass] = "{'col-md-3': showEmergency, 'col-md-4': !showEmergency}">
                <div>
                    <div class="d-flex pb-2">
                        <nb-icon icon="map-marker-alt" nbTooltip="Address" nbTooltipPlacement="left" pack="font-awesome">
                        </nb-icon>
                        <div class="ps-2">
                            <div>{{patient?.address}}, </div>
                            <div>
                                <span *ngIf="patient?.city">{{patient?.city}}, </span>
                                <span *ngIf="patient?.state">{{patient?.state}}, </span>
                                <span *ngIf="patient?.zipcode">{{patient?.zipcode}}, </span>
                                <span *ngIf="patient?.country">{{patient?.country}}</span>.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-2 mt-3" *ngIf = "showEmergency">
                    <div>
                        <div class="d-flex pb-2">
                            <nb-icon icon="address-book" nbTooltip="Emergency Contact" nbTooltipPlacement="left" pack="font-awesome">
                            </nb-icon>
                            <div class="ps-2">
                                <div *ngIf = "patientExtraData?.emergencyContact">
                                    <div>{{trimContact(patientExtraData?.emergencyContact.name)}}</div>
                                    <div>{{trimContact(patientExtraData?.emergencyContact.number)}} </div>
                                    <div *ngIf="patientExtraData?.emergencyContact.relation">{{relationName}}</div>
                                </div>
                                <div *ngIf = "!patientExtraData?.emergencyContact">
                                    No Emergency Contact Found
                                </div>
                            </div>
                        </div>
                    </div>
                <!-- <button nbButton ghost size="small" status="info" class="mb-2">Insurance</button>
                <button nbButton ghost  size="small" status="info" class="mb-2">Emergency Contact</button>
                <button nbButton ghost  size="small" status="info" class="mb-2">Devices</button> -->
            </div>
            <div class="mt-3" [ngClass] = "{'col-md-2': showEmergency, 'col-md-3': !showEmergency}">
                <button nbButton status="primary" class="mb-2 w-100 justify-content-start" size="small">
                    <nb-icon icon="message-circle-outline"></nb-icon>{{'kChat' | translate}}</button>
                <button nbButton  [nbPopover]="templateRef" nbPopoverPlacement="right" status="success" class="mb-2 w-100 justify-content-start" size="small">
                    <nb-icon icon="phone-call-outline"></nb-icon>{{'kCall' | translate}}</button>
                <button nbButton status="warning" class="mb-2 w-100 justify-content-start" size="small"><nb-icon icon="clock-outline"></nb-icon>{{'kSchedule' | translate}}</button>
            </div> 
            <ng-template #templateRef>
                <div class="p-3">
                <button nbButton status="success" class="m-1" size="small"><nb-icon icon="headphones-outline"></nb-icon>{{'kAudio' | translate}}</button>
                <button nbButton status="success" class="m-1" size="small"><nb-icon icon="video-outline"></nb-icon>{{'kVideo' | translate}}</button>
                <button nbButton status="success" class="m-1" size="small"><nb-icon icon="phone-call-outline"></nb-icon>{{'kCAllBridge' | translate}}</button>
                </div>
              </ng-template>
        </div>
        <div class="row">
            <div class="col-md-2 px-4">
                <!-- <div class="d-flex justify-content-between">
                    <span *ngIf=" message >= 0">{{minutes}} : {{message }}</span>
                    <div>
                        <button class="float-end timerButton" outline status="success" nbButton size="tiny" (click)="start()" *ngIf="startStop">Start</button>
                        <button class="float-end timerButton" outline status="danger" nbButton size="tiny"(click)="stop(message)" *ngIf="!startStop && message >= 0">Stop</button>
    
                    </div>

                </div> -->
                <!-- <div class="row">
                    <div class="col-6">
                    <div class="text-center p-2 fw-bold m-auto" *ngIf=" message >= 0">{{minutes}} : {{message }}</div>
                    <span *ngIf=" message >= 0">{{minutes}} : {{message }}</span>
                    <button class="float-end timerButton" outline status="primary" nbButton size="tiny" (click)="start()" *ngIf="startStop">Start</button>
                    <button class="float-end timerButton" outline status="primary" nbButton size="tiny"(click)="stop(message)" *ngIf="!startStop && message >= 0">Stop</button>

                    </div>
                    <div class="col-6">
                            <button class="float-end timerButton" outline status="primary" nbButton size="tiny" (click)="start()" *ngIf="startStop">Start</button>
                            <button class="float-end timerButton" outline status="primary" nbButton size="tiny"(click)="stop(message)" *ngIf="!startStop && message >= 0">Stop</button>
                    </div>
                </div> -->
            </div>
            <div class="col-md-10">
                <div class="d-flex" *ngIf="!!diseaseList?.length">
                    <nb-icon icon="notes-medical" nbTooltip="Disease State" nbTooltipPlacement="left" pack="font-awesome">
                    </nb-icon>
                    <div class="ps-2">
                        <nb-tag-list>
                            <nb-tag appearance="filled" *ngFor="let tree of diseaseList" size="tiny" [text]="tree" status="info"></nb-tag>
                        </nb-tag-list>
                    </div>
                </div>
            </div>
        </div>
    </nb-card-body>
</nb-card>
<nb-route-tabset [tabs]="tabs" *ngIf="!showPatient"></nb-route-tabset>